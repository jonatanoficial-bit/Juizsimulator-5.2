<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Jogo do Juiz ‚Äì Simulador Jur√≠dico 6.0</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --bg-dark:#020617;
  --card:#020617cc;
  --accent:#22c55e;
  --accent-soft:#22c55e33;
  --text:#e5e7eb;
  --muted:#9ca3af;
  --danger:#ef4444;
  --danger-soft:#ef444433;
  --border:#1f2937;
  --radius:18px;
  --shadow-big:0 24px 60px rgba(0,0,0,.7);
  --shadow-soft:0 18px 40px rgba(15,23,42,.9);
  --blur-bg:blur(18px);
}

*{margin:0;padding:0;box-sizing:border-box;}
body{
  background:#000;
  color:var(--text);
  font-family:system-ui,-apple-system,'Segoe UI',Roboto,sans-serif;
  overflow:hidden;
}

.bg{
  position:absolute;
  inset:0;
  background-size:cover;
  background-position:center;
  background-repeat:no-repeat;
  opacity:0;
  transition:opacity .6s ease;
}
#bg-splash{background-image:url('capa.jpg');}
#bg-office{background-image:url('escritorio.jpg');}
#bg-trial{background-image:url('saladejulgamento.jpg');}
#bg-stj{background-image:url('stjd.jpg');}

.overlay{
  position:absolute;
  inset:0;
  background:linear-gradient(to bottom,rgba(0,0,0,.55),rgba(0,0,0,.9));
  pointer-events:none;
}

.screen{
  position:absolute;
  inset:0;
  padding:1rem;
  display:none;
  overflow-y:auto;
}
.screen.active{display:block;}

.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding:1.5rem;
  backdrop-filter:var(--blur-bg);
  max-width:520px;
  width:100%;
  margin:auto;
  margin-top:2rem;
  box-shadow:var(--shadow-big);
}

.btn{
  border:none;
  border-radius:999px;
  padding:.65rem 1.2rem;
  font-size:.9rem;
  cursor:pointer;
  font-weight:600;
  transition:.15s;
}
.btn-primary{
  background:var(--accent);
  color:#022c22;
}
.btn-ghost{
  background:#ffffff14;
  color:var(--text);
  border:1px solid #ffffff22;
}

.input{
  width:100%;
  background:#0f172a99;
  border:1px solid #334155aa;
  border-radius:14px;
  padding:.6rem .7rem;
  color:var(--text);
  margin-top:.3rem;
  font-size:.9rem;
}

.list{
  max-height:400px;
  overflow:auto;
  padding-right:.4rem;
}

.case{
  background:#0f172acc;
  border:1px solid #1e293b;
  border-radius:14px;
  padding:.7rem;
  margin-bottom:.6rem;
}

.jury-grid{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:.4rem;
}
.juror{
  background:#0f172acc;
  border:1px solid #1e293b;
  border-radius:10px;
  padding:.4rem;
}
.juror-bar{
  width:100%;
  height:.4rem;
  background:#1e293b;
  border-radius:999px;
  margin-top:.2rem;
}

.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.75);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:9999;
}
.modal.active{display:flex;}
.modal-box{
  background:#0f172af2;
  border:1px solid #1e293b;
  border-radius:18px;
  padding:1.5rem;
  max-width:680px;
  width:90%;
  max-height:85vh;
  overflow:auto;
}

.typewriter{
  overflow:hidden;
  white-space:pre-wrap;
  border-right:1px solid #fff;
  animation:blink 1s infinite;
}
@keyframes blink{50%{border-color:transparent;}}

</style>
</head>

<body>

<div id="bg-splash" class="bg"></div>
<div id="bg-office" class="bg"></div>
<div id="bg-trial" class="bg"></div>
<div id="bg-stj" class="bg"></div>
<div class="overlay"></div>

<!-- ===================== TELA INICIAL ===================== -->
<section id="tela-inicial" class="screen active">
  <div class="card">
    <h1 style="font-size:2rem;font-weight:700;">Jogo do Juiz 6.0</h1>
    <p style="margin-top:.5rem;color:#cbd5e1;">Simulador jur√≠dico com IA local, carreira, estudo e STJ.</p>

    <div style="margin-top:1.2rem;display:flex;flex-direction:column;gap:.7rem;">
      <button class="btn btn-primary" onclick="abrirTutorial()">Iniciar Jogo</button>
      <button class="btn btn-ghost" onclick="abrirTutorial()">Como funciona o salvamento?</button>
    </div>

    <div style="margin-top:1rem;font-size:.8rem;color:#94a3b8;">
      Modo carreira ‚Ä¢ Modo estudo ‚Ä¢ Relat√≥rio semestral ‚Ä¢ STJ
    </div>
  </div>
</section>

<!-- ===================== TUTORIAL ===================== -->
<section id="tela-tutorial" class="screen">
  <div class="card">
    <h2>Tutorial de Salvamento</h2>
    <p style="margin-top:.6rem;color:#cbd5e1;font-size:.9rem;">
      O jogo salva automaticamente no seu navegador (localStorage).  
      Voc√™ pode exportar e importar seu progresso a qualquer momento.
    </p>

    <ul style="color:#94a3b8;font-size:.85rem;margin-top:.7rem;margin-left:1rem;">
      <li>Salvamento autom√°tico a cada julgamento conclu√≠do</li>
      <li>Funciona offline</li>
      <li>Importar e exportar saves</li>
      <li>Nunca perde progresso sem querer</li>
    </ul>

    <div style="margin-top:1rem;display:flex;gap:.7rem;">
      <button class="btn btn-primary" onclick="abrirLogin()">Avan√ßar</button>
      <button class="btn btn-ghost" onclick="voltarInicio()">Voltar</button>
    </div>
  </div>
</section>

<!-- ===================== LOGIN ===================== -->
<section id="tela-login" class="screen">
  <div class="card" style="max-width:680px;">
    <h2>Configurar Perfil</h2>

    <label>Nome do Juiz(a)</label>
    <input id="nome" class="input" type="text">

    <label style="margin-top:.7rem;">Idade</label>
    <input id="idade" class="input" type="number">

    <label style="margin-top:.7rem;">Estado</label>
    <input id="estado" class="input" type="text">

    <label style="margin-top:.7rem;">Cidade / Comarca</label>
    <input id="cidade" class="input" type="text">

    <label style="margin-top:.7rem;">Foto (avatar)</label>
    <input id="avatar" class="input" type="file" accept="image/*">

    <label style="margin-top:1rem;">Modo de jogo</label>
    <select id="modo" class="input">
      <option value="carreira">Carreira</option>
      <option value="estudo">Estudo</option>
      <option value="relatorio">Relat√≥rio</option>
    </select>

    <div style="margin-top:1rem;display:flex;gap:.7rem;">
      <button class="btn btn-primary" onclick="salvarPerfil()">Entrar no Escrit√≥rio</button>
      <button class="btn btn-ghost" onclick="voltarInicio()">Voltar</button>
    </div>
  </div>
</section>

<!-- ===================== ESCOLHER TRIBUNAL ===================== -->
<section id="tela-tribunal" class="screen">
  <div class="card" style="max-width:720px;">
    <h2>Escolher Tribunal</h2>

    <div style="margin-top:1rem;display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;">
      <div class="case">
        <h3>Criminal ‚öñÔ∏è</h3>
        <p style="font-size:.85rem;color:#94a3b8;">Crimes, j√∫ri popular, provas, laudos.</p>
        <button class="btn btn-primary" style="margin-top:.7rem;" onclick="selecionarTribunal('criminal')">Escolher</button>
      </div>

      <div class="case">
        <h3>Fam√≠lia üë®‚Äçüë©‚Äçüëß</h3>
        <p style="font-size:.85rem;color:#94a3b8;">Guarda, visita√ß√£o, pens√£o, psicossocial.</p>
        <button class="btn btn-primary" style="margin-top:.7rem;" onclick="selecionarTribunal('familia')">Escolher</button>
      </div>

      <div class="case">
        <h3>Trabalhista üíº</h3>
        <p style="font-size:.85rem;color:#94a3b8;">V√≠nculo, ass√©dio, verbas, ponto eletr√¥nico.</p>
        <button class="btn btn-primary" style="margin-top:.7rem;" onclick="selecionarTribunal('trabalhista')">Escolher</button>
      </div>
    </div>

    <button class="btn btn-ghost" style="margin-top:1rem;" onclick="voltarLogin()">Voltar</button>
  </div>
</section>

<!-- ===================== ESCRIT√ìRIO ===================== -->
<section id="tela-escritorio" class="screen">
  <div style="padding:1rem;">
    <div style="display:flex;justify-content:space-between;align-items:center;">
      <div>
        <h2>Escrit√≥rio do Juiz</h2>
        <div id="dados-juiz" style="font-size:.85rem;color:#94a3b8;margin-top:.3rem;">---</div>
      </div>

      <div style="display:flex;gap:.5rem;">
        <button class="btn btn-ghost" onclick="exportarSave()">Exportar Save</button>
        <button class="btn btn-ghost" onclick="abrirRelatorio()">Relat√≥rio</button>
      </div>
    </div>

    <h3 style="margin-top:1.2rem;">Fila de Processos</h3>
    <div id="lista-processos" class="list"></div>

    <button class="btn btn-primary" style="margin-top:1rem;" onclick="voltarTribunal()">Trocar Tribunal</button>
  </div>
</section>

<!-- ===================== SALA DE JULGAMENTO ===================== -->
<section id="tela-julgamento" class="screen">
  <div style="padding:1rem;">
    <h2>Sala de Julgamento</h2>
    <div id="titulo-caso" style="color:#94a3b8;font-size:.85rem;margin-top:.3rem;"></div>

    <div style="margin-top:1rem;display:grid;grid-template-columns:2fr 1fr;gap:1rem;">

      <div>
        <button class="btn btn-ghost" onclick="ouvirAcusacao()">Ouvir Acusa√ß√£o</button>
        <button class="btn btn-ghost" onclick="ouvirDefesa()">Ouvir Defesa</button>
        <button class="btn btn-ghost" onclick="ouvirTestemunha()">Ouvir Testemunha</button>
        <button class="btn btn-ghost" onclick="deliberarJuri()">J√∫ri Popular</button>

        <div id="fala-acusacao" class="case" style="display:none;margin-top:1rem;"></div>
        <div id="fala-defesa" class="case" style="display:none;margin-top:1rem;"></div>
        <div id="fala-testemunha" class="case" style="display:none;margin-top:1rem;"></div>

        <div class="case" style="margin-top:1rem;">
          <h3>Perguntar</h3>
          <input id="pergunta" class="input" placeholder="Digite sua pergunta">
          <button class="btn btn-primary" style="margin-top:.5rem;" onclick="perguntarIA()">Enviar</button>
          <div id="resposta-ia" style="margin-top:.7rem;"></div>
        </div>

        <div class="case" style="margin-top:1rem;display:none;" id="veredito-box">
          <button class="btn btn-danger" onclick="finalizarVeredito(true)">Condenar</button>
          <button class="btn btn-primary" onclick="finalizarVeredito(false)">Absolver</button>
        </div>
      </div>

      <div>
        <h3>Provas</h3>
        <div id="lista-provas" class="list"></div>

        <h3 style="margin-top:1rem;">J√∫ri Popular</h3>
        <div id="jury" class="jury-grid"></div>
      </div>

    </div>

    <button class="btn btn-ghost" style="margin-top:1rem;" onclick="voltarEscritorio()">Voltar</button>
  </div>
</section>
<script>
function abrirJulgamento(id){
  let caso;
  if(estadoApp.stats.stjAtivo && estadoApp.tribunal==="stj"){
    caso = estadoApp.casosSTJ.find(c=>c.id===id);
  } else {
    caso = estadoApp.casos.find(c=>c.id===id);
  }
  estadoApp.casoAtual = caso;
  document.getElementById('titulo-caso').textContent = caso.titulo;
  carregarProvas(caso.provas);
  prepararJuri();
  limparFalas();
  salvarLocal();
  showScreen('julgamento');
}

function carregarProvas(lista){
  const div = document.getElementById('lista-provas');
  div.innerHTML = "";
  lista.forEach(p=>{
    const el = document.createElement('div');
    el.className="case";
    el.style.cursor="pointer";
    el.textContent = p.id+" ‚Äì "+p.titulo;
    el.onclick = ()=>abrirModalProva(p);
    div.appendChild(el);
  });
}

function abrirModalProva(p){
  document.getElementById('modal-prova-titulo').textContent = p.id+" ‚Äì "+p.titulo;
  document.getElementById('modal-prova-conteudo').textContent = p.conteudo;
  document.getElementById('modal-prova').classList.add('active');
}
function fecharModalProva(){
  document.getElementById('modal-prova').classList.remove('active');
}

function limparFalas(){
  document.getElementById('fala-acusacao').style.display="none";
  document.getElementById('fala-defesa').style.display="none";
  document.getElementById('fala-testemunha').style.display="none";
  document.getElementById('resposta-ia').textContent = "";
  document.getElementById('veredito-box').style.display="none";
}

function ouvirAcusacao(){
  const caixa = document.getElementById('fala-acusacao');
  caixa.style.display="block";
  caixa.innerHTML = "<div class='typewriter'>"+gerarFala("acusacao")+"</div>";
  document.getElementById('veredito-box').style.display="block";
}
function ouvirDefesa(){
  const caixa = document.getElementById('fala-defesa');
  caixa.style.display="block";
  caixa.innerHTML = "<div class='typewriter'>"+gerarFala("defesa")+"</div>";
  document.getElementById('veredito-box').style.display="block";
}
function ouvirTestemunha(){
  const caixa = document.getElementById('fala-testemunha');
  caixa.style.display="block";
  caixa.innerHTML = "<div class='typewriter'>"+gerarFala("testemunha")+"</div>";
  document.getElementById('veredito-box').style.display="block";
}

function gerarFala(tipo){
  const c = estadoApp.casoAtual;
  const base = c.provas.map(p=>p.titulo).join("; ");
  if(tipo==="acusacao"){
    return "Excel√™ncia, observando as provas ("+base+"), conclui-se que h√° elementos suficientes para sustentar a tese acusat√≥ria.";
  }
  if(tipo==="defesa"){
    return "Excel√™ncia, ainda que existam elementos ("+base+"), h√° inconsist√™ncias graves que conduzem √† d√∫vida razo√°vel.";
  }
  return "Sou testemunha e declaro que os fatos apresentados se relacionam diretamente √†s provas ("+base+").";
}

function prepararJuri(){
  const j = [];
  for(let i=1;i<=12;i++){
    j.push({id:i,certeza:0,voto:null});
  }
  estadoApp.jury = j;
  renderJuri();
}

function renderJuri(){
  const div = document.getElementById('jury');
  div.innerHTML = "";
  estadoApp.jury.forEach(j=>{
    const box = document.createElement('div');
    box.className="juror";
    box.innerHTML = "J"+j.id+"<div class='juror-bar'><div style='height:100%;width:"+j.certeza+"%;background:"+(j.voto===true?'#ef4444':j.voto===false?'#22c55e':'#1e293b')+";border-radius:999px;'></div></div>";
    div.appendChild(box);
  });
}

function deliberarJuri(){
  estadoApp.jury.forEach(j=>{
    j.certeza = Math.floor(50 + Math.random()*50);
    j.voto = Math.random()<0.55;
  });
  renderJuri();
  document.getElementById('veredito-box').style.display="block";
}

function perguntarIA(){
  const p = document.getElementById('pergunta').value.trim();
  if(p===""){return;}

  const palavras = p.toLowerCase();
  let resposta = "N√£o compreendi, Excel√™ncia. Poderia reformular?";

  if(palavras.includes("hora") || palavras.includes("quando")){
    resposta = "Excel√™ncia, segundo os autos, o hor√°rio indicado coincide com o depoimento de testemunhas.";
  }
  if(palavras.includes("arma") || palavras.includes("objet")){
    resposta = "Consta no laudo que o objeto apreendido apresenta semelhan√ßa com arma real.";
  }
  if(palavras.includes("visita") || palavras.includes("crian√ßa")){
    resposta = "O parecer psicossocial orienta priorizar o melhor interesse da crian√ßa.";
  }
  if(palavras.includes("ponto") || palavras.includes("jornada")){
    resposta = "Os registros de jornada demonstram inconsist√™ncias apontadas pelas testemunhas.";
  }

  document.getElementById('resposta-ia').innerHTML = "<div class='typewriter'>"+resposta+"</div>";
}

function finalizarVeredito(condena){
  const c = estadoApp.casoAtual;
  c.julgado = true;

  const acertou = condena===c.gabarito.culpado;
  estadoApp.stats.julgados++;
  if(acertou) estadoApp.stats.acertos++;
  estadoApp.stats.iaj = Math.floor((estadoApp.stats.acertos/estadoApp.stats.julgados)*100);

  if(estadoApp.stats.julgados>=40 && estadoApp.stats.iaj>=70){
    estadoApp.stats.stjConvite = true;
  }

  salvarLocal();
  atualizarEscritorio();
  showScreen('escritorio');
}

function exportarSave(){
  const data = JSON.stringify(estadoApp);
  const blob = new Blob([data],{type:"application/json"});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = "juizSim6_save.json";
  a.click();
}

function abrirRelatorio(){
  const texto = 
    "RELAT√ìRIO SEMESTRAL\n\n"+
    "Juiz(a): "+estadoApp.perfil.nome+"\n"+
    "Comarca: "+estadoApp.perfil.cidade+"/"+estadoApp.perfil.estado+"\n\n"+
    "Julgamentos: "+estadoApp.stats.julgados+"\n"+
    "Acertos: "+estadoApp.stats.acertos+"\n"+
    "IAJ: "+estadoApp.stats.iaj+"%\n\n"+
    "STJ: "+(estadoApp.stats.stjAtivo?"Ativo":estadoApp.stats.stjConvite?"Convite dispon√≠vel":"N√£o habilitado")+"\n\n"+
    "Recomenda√ß√µes:\n"+
    "- Revisar fundamentos legais aplic√°veis.\n"+
    "- Avaliar coer√™ncia decis√≥ria.\n"+
    "- Aperfei√ßoar an√°lise probat√≥ria.\n\n";

  estadoApp.ultimoRelatorio = texto;
  document.getElementById('relatorio-texto').textContent = texto;
  showScreen('relatorio');
}

function baixarRelatorio(){
  const blob = new Blob([estadoApp.ultimoRelatorio],{type:"text/plain"});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = "relatorio_semestral.txt";
  a.click();
}

function carregarEstudo(){
  const area = document.getElementById('estudo-area').value;
  const casoBox = document.getElementById('estudo-caso');
  const comentarioBox = document.getElementById('estudo-comentario');

  casoBox.style.display="block";
  comentarioBox.style.display="block";

  casoBox.innerHTML = "<strong>Caso t√≠pico de "+area+"</strong><br>Descri√ß√£o geral do conflito ou crime.";
  comentarioBox.innerHTML = "<strong>Coment√°rio Jur√≠dico</strong><br>An√°lise resumida do fundamento legal.";
}

window.onload = ()=>{carregarLocal();}
</script>

</body>
</html>
<!-- ===================== PROMO√á√ÉO AO STJ ===================== -->
<section id="tela-promocao-stj" class="screen">
  <div class="card" style="max-width:780px;">
    <h2>Convite para o STJ</h2>
    <p style="margin-top:.5rem;font-size:.9rem;color:#cbd5e1;">
      Parab√©ns! Seu desempenho chamou aten√ß√£o da magistratura superior.  
      Voc√™ est√° apto(a) a disputar uma vaga no Superior Tribunal de Justi√ßa.
    </p>

    <ul style="margin-top:.8rem;font-size:.85rem;color:#94a3b8;line-height:1.5;">
      <li>IAJ ‚â• 70%</li>
      <li>Mais de 40 julgamentos</li>
      <li>Decis√µes consistentes</li>
      <li>Perfil adequado √† Turma</li>
    </ul>

    <div style="display:flex;gap:.6rem;margin-top:1.2rem;">
      <button class="btn btn-primary" onclick="aceitarSTJ()">Aceitar Promo√ß√£o</button>
      <button class="btn btn-ghost" onclick="recusarSTJ()">Agora n√£o</button>
    </div>

    <button class="btn btn-ghost" style="margin-top:1.2rem;" onclick="voltarEscritorio()">Voltar</button>
  </div>
</section>

<script>
function verificarSTJ(){
  if(estadoApp.stats.stjConvite && !estadoApp.stats.stjAtivo){
    showScreen('tela-promocao-stj');
  }
}

function aceitarSTJ(){
  estadoApp.stats.stjAtivo = true;
  estadoApp.tribunal = "stj";
  salvarLocal();
  atualizarEscritorio();
  showScreen('stj');
}

function recusarSTJ(){
  showScreen('escritorio');
}

function atualizarSTJ(){
  const lista = document.getElementById('lista-stj');
  lista.innerHTML = "";

  estadoApp.casosSTJ.filter(c=>!c.julgado).slice(0,50).forEach(c=>{
    const div = document.createElement('div');
    div.className="case";
    div.innerHTML = 
      "<strong>"+c.titulo+"</strong><br>"+
      "<span style='font-size:.8rem;color:#94a3b8;'>"+c.resumo+"</span><br>"+
      "<button class='btn btn-primary' style='margin-top:.4rem;' onclick=\"abrirJulgamento('"+c.id+"')\">JULGAR</button>";
    lista.appendChild(div);
  });

  gerarMinistros();
}

function gerarMinistros(){
  const nomes = [
    "Min. Arantes", "Min. Toledo", "Min. Vasconcelos", "Min. Ribeiro",
    "Min. Paiva", "Min. Mendon√ßa", "Min. Diniz", "Min. Celso Duarte",
    "Min. Ferraz", "Min. Salles"
  ];
  estadoApp.ministros = [];
  for(let i=0;i<5;i++){
    estadoApp.ministros.push({
      nome:nomes[Math.floor(Math.random()*nomes.length)],
      voto: null
    });
  }
  renderMinistros();
}

function renderMinistros(){
  const div = document.getElementById('stj-ministros');
  if(!div) return;
  div.innerHTML = "";

  estadoApp.ministros.forEach(m=>{
    const card = document.createElement('div');
    card.style.padding=".5rem";
    card.style.border="1px solid #1e293b";
    card.style.borderRadius="10px";
    card.style.background="#0f172acc";
    card.style.fontSize=".8rem";
    card.style.width="110px";

    const voto = m.voto===null?"‚Äî":(m.voto?"Condena":"Absolve");
    const cor = m.voto===null?"#94a3b8":(m.voto?"#ef4444":"#22c55e");

    card.innerHTML = 
      "<strong>"+m.nome+"</strong><br>"+
      "<span style='color:"+cor+"'>"+voto+"</span>";

    div.appendChild(card);
  });
}

function julgarSTJFinal(){
  estadoApp.ministros.forEach(m=>{
    m.voto = Math.random()<0.5 ? true : false;
  });

  renderMinistros();

  const votos = estadoApp.ministros.filter(m=>m.voto===true).length;
  const decisao = votos>=3?"Condena√ß√£o mantida":"Recurso provido";

  const textoAcordao = 
    "SUPERIOR TRIBUNAL DE JUSTI√áA\n\n"+
    "Ac√≥rd√£o\n\n"+
    "Ap√≥s an√°lise colegiada, por maioria ("+votos+"/5), ficou decidido:\n"+
    decisao+"\n\n"+
    "Publique-se. Intimem-se.";

  document.getElementById('stj-acordao').textContent = textoAcordao;
  salvarLocal();
}

document.addEventListener("keydown", e=>{
  if(e.key==="F9"){
    julgarSTJFinal();
  }
});
</script>

</body>
</html>
